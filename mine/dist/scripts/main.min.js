function Tab(t){this.tabHead=t.tabHead,this.tabBody=t.tabBody;var a={headCurClass:"cur",bodyCurClass:"cur",headItem:"",bodyItem:"",beforeClick:function(){},callback:function(){}};this.option=$.extend(!0,a,t),this.init()}seajs.config({plugins:["shim"],alias:{jquery:{src:"http://lib.sinaapp.com/js/jquery/1.9.1/jquery-1.9.1.min.js",exports:"jQuery"}},paths:{js:"../js/",lib:"../lib"},map:[[/(.*js\/[^\/\.]*\.(?:js))(?:.*)/,"$1?_="+(new Date).getTime()]],debug:!0}),define(function(t,a,e){"use strict";function s(){i(),n()}function n(){$("#J_header").on("click",".J_new",function(){$(".J_new_pop").slideToggle("fast")}).on("click",".J_msg",function(){o($(this).data("type"))}).on("click",".J_user",function(){$(".J_user_pop").slideToggle("fast")}).on("click",".J_new_project",function(){$(".J_new_project_pop").slideDown("fast")}).on("click",".J_new_team",function(){$(".J_new_team_pop").slideDown("fast")}).on("click",".J_new_cle",function(){$(this).parents(".new-pop").slideUp("fast")}).on("click",".J_btn_new_project",function(){d.newProject($(this),function(t){$("#J_header .J_new_cle").trigger("click"),$("#J_aside .a-list").each(function(){if(console.log("50",$(this),t),$(this).data("teamid")===t.teamId){var a='<li class="project-list" data-type="taskList" data-teamId="'+t.teamId+'" data-projectId="'+t.projectId+'"><span class="glyphicon glyphicon-folder-open"></span>'+t.projectname+"</li>";$(this).find("ul").append(a)}}),o("tasList",t)})}).on("click",".J_btn_new_team",function(){d.newTeam($(this),function(t){$("#J_header .J_new_cle").trigger("click"),o("team",t);var a=$("#projectower"),e='<li class="a-list" data-type="team" data-teamId="'+t.teamId+'"><span class="glyphicon glyphicon-briefcase"></span>'+t.teamname+"<ul></ul></li>";if($("#J_aside ul").append(e),a.length)a.append('<option value="'+t.teamId+'">'+t.teamname+"</option>");else{var s='<select class="new-select" name="projectower" id="projectower"><option value=="'+t.teamId+'">'+t.teamname+"</option></select>";$(".J_team_list").append(s).find("p").remove(),$(".J_btn_new_project").removeAttr("disabled")}})}).on("click",".J_team_manage",function(){o($(this).data("type"))}).on("click",".J_user_exit",function(){d.userExit($(this))}),$("#J_task_detail").on("click",".J_close_pop",function(){r()}).on("click",".J_taskdesc_cfm",function(){d.addTaskDesc($(this),function(t){$(".J_task_desc").html(t.taskdesc).next(".J_taskdesc_form").slideUp("fast")})}).on("click",".J_new_comment_cfm",function(){d.addComment($(this),function(t){var a='<li class="tab-body-list"><div class="user-img">'+t.userheader+"</div><p>"+t.username+'<span class="tab-update-time">'+t.date+'</span></p><p class="content-detail">'+t.content+"</p></li>";$("#J_task_detail .J_comment_list").append(a),$("#comment").val("")})}).on("click",".J_task_desc",function(){var t=$(this);t.slideUp("fast").next(".J_taskdesc_form").slideDown("fast"),d.addTaskDesc($(this),function(a){t.html(a.taskdesc).next(".J_taskdesc_form").slideUp("fast")})}).on("click",".J_taskdesc_cle",function(){$(this).parents(".J_taskdesc_form").slideUp("fast").prev(".J_task_desc").slideDown("fast")}),$("#article").on("click",".event-itm",function(){d.getTaskDetail($(this),c)}).on("click",".ws-2-item",function(){return d.getTaskDetail($(this),c),!1}).on("click",".J_task_title",function(){d.getTaskDetail($(this),c)}).on("click",".J_project_item",function(){var t=$(this),a={teamId:t.data("teamid"),projectId:t.data("projectid")};o($(this).data("type"),a)}).on("click",".J_new_task_btn",function(){$(this).hide().parents(".task-box").find(".form").slideDown()}).on("click",".J_new_task_cfm",function(){var t=$(this);d.newTask($(this),function(a){var e='<li><input type="checkbox" class="task-fanish J_task_fanish_btn"><span class="J_task_title task-title" data-taskId='+a.taskId+">"+a.taskname+'</span><span class="glyphicon glyphicon-remove J_delete_task"></span></li>';t.parents(".form").slideUp().parents(".task-box").find(".J_new_task_btn").show(),t.parents(".form").siblings(".task-status").after(e)})}).on("click",".J_new_task_cle",function(){$(this).parents(".form").slideUp().parents(".task-box").find(".J_new_task_btn").show()}).on("click",".J_task_fanish_btn",function(){var t=$(this);d.finishTask($(this),function(){t.next(".J_task_title").addClass("finished")})}).on("click",".J_add_teamer",function(){$(this).slideUp("fast").next(".add-teamer-form").slideDown("fast")}).on("click",".J_add_teamer_cle",function(){$(this).parents(".add-teamer-form").slideUp("fast").prev(".J_add_teamer").slideDown("fast")}).on("click",".J_add_teamer_cfm",function(){d.addTeamer($(this),function(t){var a='<li class="teamer-item J_teamer_item"><i class="user-img circle-img">'+t.userhead+"</i>"+t.teamername+"</li>";$("#J_team .J_teamer_item").parent().append(a),$(".J_add_teamer_cle").trigger("click")})}).on("click",".J_delete_task",function(){var t=$(this);d.deleteTask(t,function(){t.parent("li").remove()})}),$("#J_aside").on("click",".a-list",function(){var t=$(this);if(t.addClass("cur").siblings().removeClass("cur"),t.data("teamid")){var a={teamId:t.data("teamid")};o(t.data("type"),a)}else o(t.data("type"))}).on("click",".project-list",function(){var t=$(this),a={teamId:t.data("teamid"),projectId:t.data("projectid")};return o(t.data("type"),a),!1})}function i(){var t=new Tab({tabHead:".J_w_tab_head",tabBody:".work-space",headCurClass:"tt-cur",bodyCurClass:"cur",headItem:".tt-itm",bodyItem:".ws-main"});new Tab({tabHead:".J_tab2_head",tabBody:".J_tab2_body",headCurClass:"cur",bodyCurClass:"cur",headItem:".ws-2-tab",bodyItem:".ws-2-tab"}),new Tab({tabHead:".ws-ad-box",tabBody:".J_tab2_body",headCurClass:"cur",bodyCurClass:"cur",headItem:".aside-itm",bodyItem:".ws-2-tab",beforeClick:function(){t.click($(".J_w_tab_head .tt-itm").eq(1))}}),new Tab({tabHead:".J_dit_tab_head",tabBody:".J_dit_tab_body",headCurClass:"cur",bodyCurClass:"cur",headItem:".ditt-itm",bodyItem:".ws-2-tab"}),new Tab({tabHead:".J_ms_tab_head",tabBody:".J_ms_tab_body",headCurClass:"cur",bodyCurClass:"cur",headItem:".ms-tabs",bodyItem:".ms-tabs-item"}),new Tab({tabHead:".J_team_tab_head",tabBody:".J_team_tab_body",headCurClass:"tt-cur",bodyCurClass:"cur",headItem:".tt-itm",bodyItem:".ws-main"})}function o(t,a){console.log({type:t,data:a}),$.ajax({type:"get",data:{type:t,data:a},datatype:"json",url:"/getSection",success:function(t){$(".section").replaceWith(t)}})}function c(){$("#J_task_detail").animate({width:"55%"},1e3)}function r(){$("#J_task_detail").animate({width:"0"},1e3)}console.log(t("/src/scripts/submit"));var d=t("/src/scripts/submit").submit;t("/plugin/layer/layer");s()}),define(function(t,a,e){"use strict";function s(){n()}function n(){$("#form").on("click",".J_btn_login",function(){i()})}function i(){var t={username:$("#username").val(),password:$("#password").val()};t.username&&t.password?$.ajax({url:"/submitLogin",type:"post",data:t,success:function(t){"F"===t.success?window.alert(t.errMsg):window.location.href="/home"},error:function(t){window.alert(t.errMsg)}}):window.alert("请输入完整登陆信息")}s()}),define(function(t,a,e){"use strict";function s(){n()}function n(){$("#J_btn_register").on("click",function(){i()})}function i(){var t={username:$("#username").val(),password:$("#password").val()};t.username&&t.password?$.ajax({url:"/submitRegister",type:"post",data:t,success:function(t){console.log(t),"F"===t.success?window.alert(t.errMsg):window.location.href="/login"},error:function(t){window.alert(t.errMsg)}}):window.alert("请输入完整登陆信息")}s()}),define(function(t,a,e){"use strict";var s={newProject:function(t,a){var e={projectname:$("#projectname").val(),teamId:$("#projectower").val()};return e.projectname?void $.ajax({type:"post",url:"/submitNewProject",data:e,success:function(t){"F"===t.success?window.alert(t.errMsg):"function"==typeof a&&a.call(null,t.data)},error:function(t){layer.alert(t.errMsg)}}):(layer.alert("请填写项目名称"),!1)},newTeam:function(t,a){var e={teamname:$("#teamname").val(),teamdesc:$("#teamdesc").val()};return e.teamname?void $.ajax({type:"post",url:"/submitNewTeam",data:e,success:function(t){"F"===t.success?layer.alert(t.errMsg):"function"==typeof a&&(console.log(a),a.call(null,t.data))},error:function(t){layer.alert(t.errMsg)}}):(layer.alert("请填写团队名称"),!1)},userExit:function(t){$.ajax({type:"post",url:"/submitLogout",success:function(t){"F"===t.success?window.alert(t.errMsg):window.alert(t.message)},error:function(t){window.alert(t.errMsg)}})},quitTeam:function(t){({teamId:t.data("teamId")});$.ajax({type:"post",url:"/submitQuitTeam",success:function(t){"F"===t.success?window.alert(t.errMsg):window.alert(t.message)},error:function(t){window.alert(t.errMsg)}})},newTask:function(t,a){var e=t.parents(".J_project_title"),s={teamId:e.data("teamid"),projectId:e.data("projectid"),taskname:t.prev(".J_task_name").val(),status:e.data("status")};console.log(s),$.ajax({type:"post",url:"/submitNewTask",data:s,success:function(t){"F"===t.success?window.alert(t.errMsg):"function"==typeof a&&a.call(null,t.data)},error:function(t){window.alert(t.errMsg)}})},finishTask:function(t,a){var e=t.parents(".J_project_title"),s={teamId:e.data("teamid"),projectId:e.data("projectid"),taskId:t.next(".J_task_title").data("taskid")};$.ajax({type:"post",url:"/submitFinishTask",data:s,success:function(t){"F"===t.success?window.alert(t.errMsg):"function"==typeof a&&a.call(null,t.data)},error:function(t){window.alert(t.errMsg)}})},deleteTask:function(t,a){var e=t.parents(".J_project_title"),s={teamId:e.data("teamid"),projectId:e.data("projectid"),taskId:t.prev(".J_task_title").data("taskid")};$.ajax({type:"post",url:"/submitDeleteTask",datatype:"json",data:s,success:function(t){"F"===t.success?window.alert(t.errMsg):"function"==typeof a&&a.call(null)},error:function(t){window.alert(t.errMsg)}})},getTaskDetail:function(t,a){var e;if(t.hasClass("J_task_title")){var s=t.parents(".J_project_title");e={teamId:s.data("teamid"),projectId:s.data("projectid"),taskId:t.data("taskid")}}else e={teamId:t.data("teamid"),projectId:t.data("projectid"),taskId:t.data("taskid")};$.ajax({type:"get",url:"/getSection",datatype:"json",data:{type:"taskDetail",data:e},success:function(t){$("#J_task_detail").html(t),"function"==typeof a&&a.call(null)}})},addTeamer:function(t,a){var e={teamId:t.parents(".add-teamer-form").data("teamid"),teamername:$("#teamername").val()};return e.teamername?void $.ajax({type:"post",url:"/addTeamer",datatype:"json",data:e,success:function(t){"F"===t.success?window.alert(t.errMsg):"function"==typeof a&&a.call(null,t.data)},error:function(t){t.errMsg&&window.alert(t.errMsg)}}):(window.alert("请输入添加成员用户名"),!1)},addTaskDesc:function(t,a){var e=$(".J_taskdesc_form"),s={teamId:e.data("teamid"),projectId:e.data("projectid"),taskId:e.data("taskid"),taskdesc:$("#taskdesc").val()};$.ajax({type:"post",url:"/submitTaskDesc",datatype:"json",data:s,success:function(t){"F"===t.success?window.alert(t.errMsg):"function"==typeof a&&a.call(null,t.data)},error:function(t){t.errMsg&&window.alert(t.errMsg)}})},addComment:function(t,a){var e=$(".J_new_comment_form"),s={teamId:e.data("teamid"),projectId:e.data("projectid"),taskId:e.data("taskid"),content:$("#comment").val()};$.ajax({type:"post",url:"/submitComment",datatype:"json",data:s,success:function(t){"F"===t.success?window.alert(t.errMsg):"function"==typeof a&&a.call(null,t.data)},error:function(t){t.errMsg&&window.alert(t.errMsg)}})}};a.submit=s}),Tab.prototype={constructor:"Tab",init:function(){this.addLitener()},addLitener:function(){var t=this,a=t.option;$("body").on("click",a.headItem,function(){"function"==typeof t.option.beforeClick&&t.option.beforeClick(),t.click(this)})},click:function(t){var a=$(t),e=$(this.tabHead).find(this.option.headItem).index(a),s=$(this.tabBody).find(this.option.bodyItem).eq(e);a.addClass(this.option.headCurClass).siblings().removeClass(this.option.headCurClass),s.addClass(this.option.bodyCurClass).siblings().removeClass(this.option.bodyCurClass),"function"==typeof this.option.callback&&this.option.callback.call()}};